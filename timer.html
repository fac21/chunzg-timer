<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='UTF-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>Chun's Pomodoro Timer</title>
</head>
<body>
    
    <main class='center stack'>
        <button class='timer-button'></button>
        <section class='one'>
            <h1>Work</h1>
            <p><span class='work-timer'>00:00</span></p>
            <form>
                <label for='length'>How long do you want to work for?</label>
                <input type='number' value='25' id='length'>
            </form>
            <p class='stack-sm'>
                <button class='start-work'>start</button>
                <button class='cancel-work'>cancel</button>
            </p>
        </section>
        <section class='two'>
            <h1>Break</h1>
            <h2>5 mins</h2>
            <p><span class='break-timer'>00:00</span></p>
            <p class='stack-sm'>
                <button class='start-break'>start</button>
                <button class='cancel-break'>cancel</button>
            </p>
        </section>
    </main>
    <audio id='audio' src='http://www.soundjay.com/button/beep-07.wav' autoplay='false'></audio>

<script>
const startWBtn = document.querySelector('.start-work');
const cancelWBtn = document.querySelector('.cancel-work');
const wTimer = document.querySelector('.work-timer');
const startBBtn = document.querySelector('.start-break');
const cancelBBtn = document.querySelector('.cancel-break');
const bTimer = document.querySelector('.break-timer');
const showBtn = document.querySelector('.timer-button');
const sectionTwo = document.querySelector('.two');
const sectionOne = document.querySelector('.one');
const sound = document.querySelector('#audio');
let intervalId;
let intervalId2;

//Work timer
let wTime;
let updatedTime;

//Custom timer lengths
function getCustomTime() {
    let val = document.querySelector('#length').value;
    let wStartingMins = val;
    wTime = wStartingMins * 60;
}

function startCountdown() {
    intervalId = setInterval(timerFunc, 1000);
}

const playSound = () => {
    sound.play()
}
        
function timerFunc() {
    if(updatedTime === wTime) {
        getCustomTime()
        let minutes = Math.floor(wTime / 60) //total seconds divided by 60
        let seconds = wTime % 60
        minutes = minutes < 10 ? '0' + minutes : minutes;
        seconds = seconds < 10 ? '0' + seconds : seconds;
        wTimer.textContent = `${minutes}:${seconds}`;
        wTime--;
    } else {
        let minutes = Math.floor(wTime / 60) //total seconds divided by 60
        let seconds = wTime % 60 //total seconds mod 60 (remainder of minutes)
        if(minutes < 0 && seconds < 0) {
            playSound();
            return;
        } else {
            wTime--
        }
        minutes = minutes < 10 ? '0' + minutes : minutes;
        seconds = seconds < 10 ? '0' + seconds : seconds;
        wTimer.textContent = `${minutes}:${seconds}`;
    }
}

function wStartOrPause() {
	if(!intervalId) { //if not currently counting down
		intervalId = setInterval(timerFunc, 1000); //start timer
        startWBtn.textContent = 'pause'; //change btn to pause
	} else {
		clearInterval(intervalId);
		intervalId = null; 
		startWBtn.textContent = 'start';
	}
}
startWBtn.addEventListener('click', wStartOrPause);

function wCancelTimer() {
    let alert = confirm('Are you sure you want to stop this session?')
    if(alert) {
        wTimer.textContent = '00:00'
        getCustomTime()
        clearInterval(intervalId); //cancels the timer
        intervalId = null; //this fixes the having to click on start twice
        startWBtn.textContent = 'start';
    } else if(!alert && startWBtn.textContent === 'start') {
        intervalId = setInterval(timerFunc, 1000);
        startWBtn.textContent = 'pause'; 
    } else {
        startWBtn.textContent = 'pause'; 
    }
}
cancelWBtn.addEventListener('click', wCancelTimer)

//Break timer
let bStartingMins = 5;
let bTime = bStartingMins * 60;

function startCountdown2() {
    intervalId2 = setInterval(timerFunc2, 1000);
}
        
function timerFunc2() {
    let minutes = Math.floor(bTime / 60)
    let seconds = bTime % 60
    if(minutes < 0 && seconds < 0) {
        playSound();
        return;
    } else {
        bTime--
    }
    minutes = minutes < 10 ? '0' + minutes : minutes;
    seconds = seconds < 10 ? '0' + seconds : seconds;
    bTimer.textContent = `${minutes}:${seconds}`
}

function bStartOrPause() {
	if(!intervalId2) { //if not currently counting down
		intervalId2 = setInterval(timerFunc2, 1000);
        startBBtn.textContent = 'pause'; //change btn to pause
	} else {
		clearInterval(intervalId2);
		intervalId2 = null; 
		startBBtn.textContent = 'start';
	}
}
startBBtn.addEventListener('click', bStartOrPause);

function bCancelTimer() {
    const alert = confirm('Are you sure you want to stop this session?')
    if(alert) {
        clearInterval(intervalId2);
        startBBtn.textContent = 'start';
        bTimer.textContent = bStartingMins + ':00'
    }
}
cancelBBtn.addEventListener('click', bCancelTimer);

showBtn.textContent = 'Break Timer' //has to be assignment operator here

function showTimer() {
    if(showBtn.textContent === 'Break Timer') { //has to be comparison operator here
        sectionTwo.style.display = 'block';
        sectionOne.style.display = 'none';
        showBtn.textContent = 'Work Timer'; //has to be assignment operator here
    } else if(showBtn.textContent === 'Work Timer') {
        sectionTwo.style.display = 'none'; 
        sectionOne.style.display = 'block';
        showBtn.textContent = 'Break Timer';
    }
}
showBtn.addEventListener('click', showTimer);

</script>
<style>
* {
    font-family: Epilogue;
    font-size: 1.3rem;
    /* color: rgb(152, 0, 66); */
    color: rgb(249, 64, 32);
}
html {
    background: rgb(249, 64, 32);
}
.two {
    display: none;
}
.center {
    display: flex;
    flex-direction: column;
    max-width: 30rem;
    margin: auto;
    align-items: center;
    justify-content: center;
    letter-spacing: 0.1rem;
    text-align: center;
}
.stack > * {
    margin-top: 5rem;
}
.stack-sm > * {
    margin-top: 1rem;
}
h1 {
    font-size: 2rem;
}
h2 {
    font-size: 1rem;
}
button {
    background-color: rgb(249, 64, 32);
    border: none;
    border-radius: 1.5rem;
    color: white;
    padding: .8rem 2rem;
    text-align: center;
    font-size: .8rem;
    box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
}
button:hover {
    cursor: pointer;
}
span {
    font-size: 4rem;
}
section {
    background: honeydew;
    padding: 5rem;
    border-radius: 50%;
}


</style>
</body>

</html>